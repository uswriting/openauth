---
title: MicrosoftProvider
editUrl: https://github.com/openauthjs/openauth/blob/master/packages/openauth/src/provider/microsoft.ts
description: Reference doc for the `MicrosoftProvider`.
---

import Segment from '../../../../components/tsdoc/Segment.astro';
import Section from '../../../../components/tsdoc/Section.astro';
import NestedTitle from '../../../../components/tsdoc/NestedTitle.astro';
import InlineSection from '../../../../components/tsdoc/InlineSection.astro';
import { Tabs, TabItem } from '@astrojs/starlight/components';

<div class="tsdoc">
<Section type="about">
Use this provider to authenticate with Microsoft. Supports both OAuth2 and OIDC.

#### Using OAuth

```ts {5-9}
import { MicrosoftProvider } from "@uswriting/openauth/provider/microsoft"

export default issuer({
  providers: {
    microsoft: MicrosoftProvider({
      tenant: "1234567890",
      clientId: "1234567890",
      clientSecret: "0987654321"
    })
  }
})
```

#### Using OIDC

```ts {5-7}
import { MicrosoftOidcProvider } from "@uswriting/openauth/provider/microsoft"

export default issuer({
  providers: {
    microsoft: MicrosoftOidcProvider({
      clientId: "1234567890"
    })
  }
})
```
</Section>
---
## Methods
### MicrosoftOidcProvider
<Segment>
<Section type="signature">
```ts
MicrosoftOidcProvider(config)
```
</Section>
<Section type="parameters">
#### Parameters
- <p><code class="key">config</code> [<code class="type">MicrosoftOidcConfig</code>](/docs/provider/microsoft#microsoftoidcconfig)</p>
The config for the provider.
</Section>
<InlineSection>
**Returns** <code class="type">Provider</code>
</InlineSection>
Create a Microsoft OIDC provider.

This is useful if you just want to verify the user's email address.
```ts
MicrosoftOidcProvider({
  clientId: "1234567890"
})
```
</Segment>
### MicrosoftProvider
<Segment>
<Section type="signature">
```ts
MicrosoftProvider(config)
```
</Section>
<Section type="parameters">
#### Parameters
- <p><code class="key">config</code> [<code class="type">MicrosoftConfig</code>](/docs/provider/microsoft#microsoftconfig)</p>
The config for the provider.
</Section>
<InlineSection>
**Returns** <code class="type">Provider</code>
</InlineSection>
Create a Microsoft OAuth2 provider.
```ts
MicrosoftProvider({
  tenant: "1234567890",
  clientId: "1234567890",
  clientSecret: "0987654321"
})
```
</Segment>
## MicrosoftConfig
<Segment>
<Section type="parameters">
- <p>[<code class="key">clientID</code>](#microsoftconfig.clientid) <code class="primitive">string</code></p>
- <p>[<code class="key">clientSecret</code>](#microsoftconfig.clientsecret) <code class="primitive">string</code></p>
- <p>[<code class="key">query?</code>](#microsoftconfig.query) <code class="primitive">Record</code><code class="symbol">&lt;</code><code class="primitive">string</code>, <code class="primitive">string</code><code class="symbol">&gt;</code></p>
- <p>[<code class="key">scopes</code>](#microsoftconfig.scopes) <code class="primitive">string</code><code class="symbol">[]</code></p>
- <p>[<code class="key">tenant</code>](#microsoftconfig.tenant) <code class="primitive">string</code></p>
</Section>
</Segment>
<NestedTitle id="microsoftconfig.clientid" Tag="h4" parent="MicrosoftConfig.">clientID</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">string</code>
</InlineSection>
</Section>
The client ID.

This is just a string to identify your app.
```ts
{
  clientID: "my-client"
}
```
</Segment>
<NestedTitle id="microsoftconfig.clientsecret" Tag="h4" parent="MicrosoftConfig.">clientSecret</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">string</code>
</InlineSection>
</Section>
The client secret.

This is a private key that's used to authenticate your app. It should be kept secret.
```ts
{
  clientSecret: "0987654321"
}
```
</Segment>
<NestedTitle id="microsoftconfig.query" Tag="h4" parent="MicrosoftConfig.">query?</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">Record</code><code class="symbol">&lt;</code><code class="primitive">string</code>, <code class="primitive">string</code><code class="symbol">&gt;</code>
</InlineSection>
</Section>
Any additional parameters that you want to pass to the authorization endpoint.
```ts
{
  query: {
    access_type: "offline",
    prompt: "consent"
  }
}
```
</Segment>
<NestedTitle id="microsoftconfig.scopes" Tag="h4" parent="MicrosoftConfig.">scopes</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">string</code><code class="symbol">[]</code>
</InlineSection>
</Section>
A list of OAuth scopes that you want to request.
```ts
{
  scopes: ["email", "profile"]
}
```
</Segment>
<NestedTitle id="microsoftconfig.tenant" Tag="h4" parent="MicrosoftConfig.">tenant</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">string</code>
</InlineSection>
</Section>
The tenant ID of the Microsoft account.

This is usually the same as the client ID.
```ts
{
  tenant: "1234567890"
}
```
</Segment>
## MicrosoftOidcConfig
<Segment>
<Section type="parameters">
- <p>[<code class="key">clientID</code>](#microsoftoidcconfig.clientid) <code class="primitive">string</code></p>
- <p>[<code class="key">query?</code>](#microsoftoidcconfig.query) <code class="primitive">Record</code><code class="symbol">&lt;</code><code class="primitive">string</code>, <code class="primitive">string</code><code class="symbol">&gt;</code></p>
- <p>[<code class="key">scopes?</code>](#microsoftoidcconfig.scopes) <code class="primitive">string</code><code class="symbol">[]</code></p>
</Section>
</Segment>
<NestedTitle id="microsoftoidcconfig.clientid" Tag="h4" parent="MicrosoftOidcConfig.">clientID</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">string</code>
</InlineSection>
</Section>
The client ID.

This is just a string to identify your app.
```ts
{
  clientID: "my-client"
}
```
</Segment>
<NestedTitle id="microsoftoidcconfig.query" Tag="h4" parent="MicrosoftOidcConfig.">query?</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">Record</code><code class="symbol">&lt;</code><code class="primitive">string</code>, <code class="primitive">string</code><code class="symbol">&gt;</code>
</InlineSection>
</Section>
Any additional parameters that you want to pass to the authorization endpoint.
```ts
{
  query: {
    prompt: "consent"
  }
}
```
</Segment>
<NestedTitle id="microsoftoidcconfig.scopes" Tag="h4" parent="MicrosoftOidcConfig.">scopes?</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">string</code><code class="symbol">[]</code>
</InlineSection>
</Section>
A list of OIDC scopes that you want to request.
```ts
{
  scopes: ["openid", "profile", "email"]
}
```
</Segment>
</div>